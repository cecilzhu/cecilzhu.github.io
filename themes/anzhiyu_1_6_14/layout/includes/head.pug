- var pageTitle
- is_archive() ? page.title = findArchivesTitle(page, theme.menu, date) : ''
- if (is_tag()) pageTitle = _p('page.tag') + ': ' + page.tag
- else if (is_category()) pageTitle = _p('page.category') + ': ' + page.category
- else if (is_current('/404.html', [strict])) pageTitle = _p('error404')
- else pageTitle = page.title || config.title || ''

- var isSubtitle = config.subtitle ? ' - ' + config.subtitle : ''
- var tabTitle = is_home() || !pageTitle ? config.title + isSubtitle : pageTitle + ' | ' + config.title

- var pageKeywords
- if (page.keywords) pageKeywords = Array.isArray(page.keywords) ? (page.keywords).join(',') :  ([]).join(',') || page.keywords
- else if (page.tags && page.tags.length) pageKeywords = page.tags.data.map(function(tag) {return tag.name;}).join(',')
- else pageKeywords = Array.isArray(config.keywords) ? (config.keywords).join(','):  ([]).join(',') || config.keywords
- var pageAuthor = config.email ? config.author + ',' + config.email : config.author
- var pageCopyright = config.copyright || config.author
- var themeColorLight = theme.theme_color && theme.theme_color.enable && theme.theme_color.meta_theme_color_light || '#ffffff'
- var themeColorDark = theme.theme_color && theme.theme_color.enable && theme.theme_color.meta_theme_color_dark || '#0d0d0d'
- var themeColor = theme.display_mode === 'dark' ? themeColorDark : themeColorLight

meta(charset='UTF-8')
meta(http-equiv="X-UA-Compatible" content="IE=edge")
meta(name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=no")
title= tabTitle
if pageKeywords
  meta(name="keywords" content=pageKeywords)
meta(name="author" content=pageAuthor)
meta(name="copyright" content=pageCopyright)
meta(name ="format-detection" content="telephone=no")
meta(name="theme-color" content=themeColor)
meta(name="mobile-web-app-capable", content="yes")
meta(name="apple-touch-fullscreen", content="yes")
meta(name="apple-mobile-web-app-title", content=pageTitle)
meta(name="application-name", content=pageTitle)
meta(name="apple-mobile-web-app-capable", content="yes")
meta(name="apple-mobile-web-app-status-bar-style", content=themeColor)


//- 網站驗證
!=partial('includes/head/site_verification', {}, {cache: true})

//- PWA
if (theme.pwa && theme.pwa.enable)
  !=partial('includes/head/pwa', {}, {cache: true})

//- Open_Graph
include ./head/Open_Graph.pug

!=favicon_tag(theme.favicon || config.favicon)
link(rel="canonical" href=urlNoIndex())

//- 預解析
!=partial('includes/head/preconnect', {}, {cache: true})

//-【自定义】 E:\hexopack\blog\themes\anzhiyu14\layout\includes\head.pug
link(rel="preconnect" href="//yujun.netlify.app/.netlify/functions/twikoo" crossorigin="anonymous")
link(rel="preconnect" href="//www.jinrishici.com" crossorigin="anonymous")
link(rel="preconnect" href="//restapi.amap.com/v3/ip?key=42bfe95a2f2a3447166ce8c7503daa8c" crossorigin="anonymous")
//- link(rel="preconnect" href="//cloudflareinsights.com/cdn-cgi/rum" crossorigin="anonymous")
link(rel="preconnect" href="//pagead2.googlesyndication.com" crossorigin="anonymous")
link(rel="preconnect" href="//fonts.googleapis.com" crossorigin="anonymous")
link(rel="preconnect" href="//fundingchoicesmessages.google.com" crossorigin="anonymous")
//- link(rel="preconnect" href="//www.googletagmanager.com" crossorigin="anonymous")

//- link(rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap_index.xml")
link(rel="sitemap" type="application/xml" title="Sitemap" href="/sitemap.xml")
link(rel="sitemap" type="text/plain" title="Sitemap"  href="/sitemap.txt")

link(rel="prefetch" href="/images/ggL.webp" as="image")
link(rel="prefetch" href="https://emotion.acs.pw/emotion/Heo-100/%E7%8B%97%E5%A4%B4%E8%8A%B1.png" as="image")
link(rel="prefetch" href="/img/default_cover.webp" as="image")
link(rel="prefetch" href="/img/10.webp" as="image")
link(rel="prefetch" href="/img/12.webp" as="image")
link(rel="prefetch" href="/icons/icon-66x66.webp" as="image")
link(rel="prefetch" href="/icons/icon-96x96.webp" as="image")

link(rel="prefetch" href="/css/index.css" as="style")
link(rel="prefetch" href=url_for(theme.asset.ali_iconfont_css) as="style")
link(rel="prefetch" href="https://cdn.cbd.int/hexo-butterfly-clock-anzhiyu@1.1.8/lib/clock.min.css" as="style")

link(rel="prefetch", href=url_for(theme.asset.lazyload) as="script" crossorigin="anonymous")
link(rel="prefetch" href="/sw.js" as="script")
link(rel="prefetch" href="/sw-dom.js" as="script")
link(rel="prefetch", href=url_for(theme.asset.utils) as="script")
link(rel="prefetch", href=url_for(theme.asset.main) as="script")
link(rel="prefetch" href=url_for(theme.asset.pangu) as="script" crossorigin="anonymous")
link(rel="prefetch" href=url_for(theme.asset.translate) as="script" crossorigin="anonymous")

link(rel="prefetch" href="/js/anzhiyu/comment_barrage.js" as="script")
link(rel="prefetch" href="/anzhiyu/random.js" as="script")
link(rel="prefetch" href="/js/search/local-search.js" as="script")
link(rel="prefetch" href=url_for(theme.asset.typed) as="script" crossorigin="anonymous")
link(rel="prefetch" href="/search.xml" as="document")
link(rel="prefetch" href=url_for(theme.asset.meting_js) as="script")
link(rel="prefetch" href="/js/anzhiyu/people.js" as="script")
link(rel="prefetch" href=url_for(theme.asset.gsap_js) as="script" crossorigin="anonymous")
link(rel="prefetch" href=url_for(theme.asset.aplayer_js) as="script" crossorigin="anonymous")
link(rel="prefetch" href=url_for(theme.asset.fancybox) as="script" crossorigin="anonymous")
link(rel="prefetch" href="https://pagead2.googlesyndication.com/pagead/js/adsbygoogle.js" as="script" crossorigin="anonymous")
link(rel="prefetch" href=url_for(theme.asset.twikoo) as="script" crossorigin="anonymous")
//- link(rel="prefetch" href="https://www.googletagmanager.com/gtag/js?id=G-M6WPEJRYFM" as="script" crossorigin="anonymous")
//-【自定义】

//- animation依赖
if (theme.icons && theme.icons.fontawesome_animation_css)
  link(rel="stylesheet", href=url_for(theme.icons.fontawesome_animation_css))

link(rel="stylesheet" href=url_for(theme.asset.ali_iconfont_css))
//- main css
link(rel='stylesheet', href=url_for(theme.asset.main_css))


if (theme.icons && theme.icons.fontawesome)
  link(rel='stylesheet', href=url_for(theme.asset.fontawesome) media="print" onload="this.media='all'")

if (theme.snackbar && theme.snackbar.enable)
  link(rel='stylesheet', href=url_for(theme.asset.snackbar_css) media="print" onload="this.media='all'")

if site.data.essay || theme.home_top.swiper.enable
  link(rel='stylesheet' href=url_for(theme.home_top.swiper.swiper_css) media="print" onload="this.media='all'")

link(rel='stylesheet' href=url_for(theme.asset.aplayer_css) media="print" onload="this.media='all'")

if theme.fancybox
  link(rel='stylesheet' href=url_for(theme.asset.fancybox_css) media="print" onload="this.media='all'")

//- analytics
!=partial('includes/head/analytics', {}, {cache: true})

//- font
if theme.blog_title_font &&　theme.blog_title_font.font_link
  link(rel='stylesheet' href=url_for(theme.blog_title_font.font_link) media="print" onload="this.media='all'")

//- global config
!=partial('includes/head/config', {}, {cache: true})

include ./head/config_site.pug
include ./head/noscript.pug

!=fragment_cache('injectHeadJs', function(){return inject_head_js()})

!=fragment_cache('injectHead', function(){return injectHtml(theme.inject.head)})

//- google_adsense
!=partial('includes/head/google_adsense', {}, {cache: true})

//- 手动插入 额外的sitemap.txt引入
//-link(rel='sitemap' type="text/plain" title="Sitemap"  href="/sitemap.txt")

